<!DOCTYPE html>
<html>
<head>  
  <meta charset="UTF-8">
</head>
<body>
<h2>E2: please check the console.</h2>
<script>
const asuper = {
  foo: 'hello'
};
const obj0025 = {
  foo: 'world',
  find() {
    return super.foo;
  }
};

Object.setPrototypeOf(obj0025, asuper);
console.log(obj0025.find()); // "hello"
//---------------------------------------------------------
let seta = new Set([1,2,3,4]);
let setb = new Set([2,9]); 
let set_union = new Set([...seta, ...setb]); 
let set_intersect = new Set([...seta].filter(x => setb.has(x))); 
let set_diff = new Set([...seta].filter(x => !setb.has(x))); 
console.log(set_union);
console.log(set_intersect);
console.log(set_diff);
//---------------------------------------------------------
var func_add = new Function('x', 'y', 'return x+y'); 
console.log("function add result: " , func_add(10,20)); 

let arr0 = [1,2,3,4,7,9];
console.log("arr0", arr0); 
console.log("arr0.map", arr0.map(x => x*x));
console.log("arr0.reduce", arr0.reduce((x,y) => x*y ));   

function  string2int(s) {
  var nums = s.split('');
  var nums_2 = nums.map((x,index) => x * Math.pow(10, nums.length - index -1)); 
  //console.log(nums_2); 
  return nums_2.reduce((x, y) => x+y);
} 
function test0(){
  if (string2int('0') === 0 && string2int('12345') === 12345 
      && string2int('12300') === 12300) {
    if (string2int.toString().indexOf('parseInt') !== -1) {
        console.log('请勿使用parseInt()!');
    } else if (string2int.toString().indexOf('Number') !== -1) {
        console.log('请勿使用Number()!');
    } else {
        console.log('Test Pass!');
    }
  } else {
    console.log('Test Failure!');
  }
}
test0(); 
//---------------------------------------------------------
// Closure
function lazySum (arr){
  var sum = function() {
    return arr.reduce((x, y) => x + y);
  }
  return sum;
}
var mysum = lazySum ([10,20,20]); 
console.log("Sum of the array:", mysum()); 

function count() {
  var arr = [];
  for (let i=1; i<=3; i++) {
    arr.push(function () {
        return i * i;
    });
  }
  return arr;
}
var fresults = count();
var ff1 = fresults[0];
var ff2 = fresults[1];
var ff3 = fresults[2];
console.log(ff1(), ff2(), ff3());

function create_counter(init) {
  var c = init || 0;
  return {
    inc : function(){
      c++; 
      return c;  
    }
  }
}
var mycounter = create_counter(); 
console.log(mycounter.inc()); 
console.log(mycounter.inc()); 
console.log(mycounter.inc()); 
//---------------------------------------------------------
var person = {
  birth: 1990,
  getAge : function (){
    var b = this.birth; 
    var fage = function() {
      return new Date().getFullYear() - this.birth; // this point to window or undefined
    }; 
    return fage(); 
  }
}
console.log(person.getAge());   //Not work

var person2 = {
  birth: 1990,
  getAge : function (){
    var b = this.birth; 
    var fage = () => new Date().getFullYear() - this.birth; // this point to the current object: person2
    return fage(); 
  }
}
console.log(person2.getAge());  // Works

var person3 = {
  birth: 1990,
  getAge : function (){
    return new Date().getFullYear() - this.birth; 
  }
}
console.log(person3.getAge());  // Works

var person4 = {
  birth: 1990
}
person4.getAge = () => {return new Date().getFullYear() - this.birth}; 
console.log(person4.getAge());  // Not work




</script>
</body>
</html>
